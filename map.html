<!DOCTYPE html>

<html lang="en-us">

<head>

    <meta charset='UTF-8'>
    <title>Employee Timesheets</title>

    <!-- Bootstrap CDN -->
    <link rel='stylesheet' href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Slackey|Mandali" rel="stylesheet">    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.9.3/firebase.js"></script>
    <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>

    <style>
            /* Always set the map height explicitly to define the size of the div
             * element that contains the map. */
            #pokemap {
              height: 1000px;
              width: 1000px;
            }
            /* Optional: Makes the sample page fill the window. */
            html, body {
              height: 100%;
              margin: 0;
              padding: 0;
            }
    </style>
</head>
<body>
    <div id="pokemap"></div>
    
    <script>

        //////BEGIN TEST/////

        var valueString = "[Google Maps](https://www.google.com/maps?q=40.7624565647865,-74.4222888268875)";
        var valueSlice = valueString.slice(44, 78);
        console.log(valueSlice);
        var slice1 = valueSlice.slice(0, 16);
        console.log(slice1);
        var slice2 = valueSlice.slice(17,34);
        console.log(slice2);

        /////END TEST////

        console.log("-------");

        ////initialize map centered on Philly///
        var map;

        function initMap() {
            map = new google.maps.Map(document.getElementById('pokemap'), {
            zoom: 12,
            center: new google.maps.LatLng(39.952768, -75.163027),
            mapTypeId: 'roadmap'
            });
        }

        var source = {
            "async": true,
            "crossDomain": true,
            "url": "https://cors-anywhere.herokuapp.com/https://discordapp.com/api/channels/563834169579405341/messages?limit=100",
            "method": "GET",
            "headers": {
            "Authorization": "Bot NTY1OTY1NDQ2MzkwNDgwOTA2.XLCe1w.ACa_D7B90zXvjjZ6ynfGt5GChwg",
            "cache-control": "no-cache",
            "Postman-Token": "8ad414b0-260c-43a8-add3-42e2f058d4e1",
                }
        }

        $.ajax(source).then(function (response) {
            console.log(response);

            for (var i = 0; i < response.length; i++) {

                var coords = [];

                var coordigin = response[i].embeds[0].fields[2].value;
                var coordString = coordigin.slice(44, 78);
                var coordLat = coordString.slice(0,16);
                var coordLong = coordString.slice(17,34);
                coords.push(coordLong);
                coords.push(coordLat);

                var latLng = new google.maps.LatLng(coords[1],coords[0]);
                var marker = new google.maps.Marker({
                        position: latLng,
                        map: map
                        });
            }   
      });

    </script>

    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA9_6CoYezDMp-DaySMAxJyWV8gzGSavRE&callback=initMap">
    </script>

</body>
</html>